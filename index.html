<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vision AI: Text-to-Video Generator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom font import (Inter is standard for Tailwind) */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        :root {
            --primary-color: #6d28d9; /* Deep Violet */
            --accent-color: #22d3ee;  /* Cyan */
            --bg-dark: #0f172a;       /* Slate 900 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: white;
        }
        .container-section {
            display: none;
            min-height: calc(100vh - 80px); /* Adjust for header height */
        }
        .active-section {
            display: block;
        }
        .btn-primary {
            @apply px-6 py-3 font-semibold text-white transition duration-300 ease-in-out rounded-xl shadow-lg transform hover:scale-[1.02] bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700;
        }
        .nav-link {
            @apply p-2 rounded-lg text-gray-300 hover:bg-gray-700 hover:text-white transition duration-200;
        }
    </style>
</head>
<body>

    <!-- Header / Navigation -->
    <header class="bg-slate-900 shadow-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-20">
            <h1 class="text-3xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400">
                Vision AI
            </h1>
            <nav class="flex space-x-4">
                <button class="nav-link" data-section="home">Home</button>
                <button class="nav-link" data-section="generator">Studio</button>
                <button class="nav-link" data-section="gallery">Gallery</button>
                <button class="btn-primary py-2 px-4 text-sm" onclick="showSection('generator')">
                    Start Creating
                </button>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- 1. Home Section -->
        <section id="home" class="container-section active-section">
            <div class="text-center py-20">
                <h2 class="text-6xl font-extrabold mb-4 tracking-tighter leading-tight">
                    Turn Your <span class="text-cyan-400">Words</span> into Stunning <span class="text-purple-400">Videos</span>.
                </h2>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto mb-10">
                    Harness the power of the latest AI models to craft cinematic, high-quality video content from any text prompt, instantly.
                </p>
                <button class="btn-primary text-lg" onclick="showSection('generator')">
                    Start Generating Your Video Now!
                    <i data-lucide="sparkles" class="inline-block w-6 h-6 ml-2"></i>
                </button>
            </div>

            <!-- Featurette Grid -->
            <div class="grid md:grid-cols-3 gap-8 mt-20">
                <div class="bg-slate-800 p-6 rounded-xl border border-purple-700/50 hover:border-purple-500 transition duration-300 shadow-xl">
                    <i data-lucide="fast-forward" class="w-8 h-8 text-cyan-400 mb-3"></i>
                    <h3 class="text-2xl font-bold mb-2">Blazing Speed</h3>
                    <p class="text-gray-400">Generate 15-second clips in under 60 seconds using optimized, cutting-edge parallel processing.</p>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-purple-700/50 hover:border-purple-500 transition duration-300 shadow-xl">
                    <i data-lucide="palette" class="w-8 h-8 text-cyan-400 mb-3"></i>
                    <h3 class="text-2xl font-bold mb-2">Cinematic Quality</h3>
                    <p class="text-gray-400">Achieve photorealistic, stable, and high-resolution video output that rivals traditional studio quality.</p>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-purple-700/50 hover:border-purple-500 transition duration-300 shadow-xl">
                    <i data-lucide="sliders-horizontal" class="w-8 h-8 text-cyan-400 mb-3"></i>
                    <h3 class="text-2xl font-bold mb-2">Total Customization</h3>
                    <p class="text-gray-400">Control camera movements, lighting, art style, and aspect ratio with granular prompt control.</p>
                </div>
            </div>
        </section>

        <!-- 2. Generator Section (Studio) -->
        <section id="generator" class="container-section">
            <h2 class="text-4xl font-extrabold mb-8 pt-8">The Generation Studio</h2>
            <div class="grid lg:grid-cols-3 gap-8">
                
                <!-- Input Panel -->
                <div class="lg:col-span-2 bg-slate-800 p-6 rounded-xl shadow-2xl border border-slate-700 h-full">
                    <h3 class="text-2xl font-semibold mb-4 text-purple-300">Prompt Input</h3>
                    <div class="mb-4">
                        <label for="prompt-text" class="block text-sm font-medium text-gray-300 mb-2">Describe Your Vision:</label>
                        <textarea id="prompt-text" rows="6" class="w-full p-3 bg-slate-900 border border-slate-700 rounded-lg focus:ring-cyan-500 focus:border-cyan-500 text-white" placeholder="Example: A lone astronaut stands on a misty, neon-lit cyberpunk street at night. Extreme close-up shot, 8K, cinematic lighting."></textarea>
                    </div>

                    <div class="grid sm:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label for="style-select" class="block text-sm font-medium text-gray-300 mb-2">Visual Style:</label>
                            <select id="style-select" class="w-full p-3 bg-slate-900 border border-slate-700 rounded-lg focus:ring-cyan-500 focus:border-cyan-500 text-white">
                                <option value="cinematic">Cinematic Realism</option>
                                <option value="anime">Studio Ghibli Anime</option>
                                <option value="photorealistic">Photorealistic (4K)</option>
                                <option value="abstract">Abstract Fluid Dynamics</option>
                            </select>
                        </div>
                        <div>
                            <label for="ratio-select" class="block text-sm font-medium text-gray-300 mb-2">Aspect Ratio:</label>
                            <select id="ratio-select" class="w-full p-3 bg-slate-900 border border-slate-700 rounded-lg focus:ring-cyan-500 focus:border-cyan-500 text-white">
                                <option value="16:9">16:9 (Landscape - YouTube)</option>
                                <option value="9:16">9:16 (Vertical - Shorts/Reels)</option>
                                <option value="1:1">1:1 (Square - Social Media)</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn-primary w-full text-xl" id="generate-button" onclick="handleGenerateVideo()">
                        <i data-lucide="video" class="inline-block w-6 h-6 mr-2"></i>
                        Generate Video
                    </button>
                    
                    <div id="loading-indicator" class="mt-4 hidden text-center p-3 rounded-lg bg-indigo-900/50 text-indigo-300">
                        <i data-lucide="loader" class="inline-block w-5 h-5 animate-spin mr-2"></i>
                        Generating... Please wait 30 seconds.
                    </div>
                </div>

                <!-- Results Panel -->
                <div class="lg:col-span-1 bg-slate-900 p-6 rounded-xl shadow-2xl border border-slate-700">
                    <h3 class="text-2xl font-semibold mb-4 text-cyan-300">Generated Result</h3>
                    
                    <div id="video-result" class="min-h-[250px] flex items-center justify-center rounded-lg bg-slate-700/50 border-4 border-dashed border-cyan-500/30">
                        <p class="text-gray-400">Your video will appear here after generation.</p>
                    </div>

                    <div id="result-details" class="mt-4 hidden">
                        <p class="text-lg font-bold text-cyan-400 mb-2">Generation Complete!</p>
                        <p class="text-sm text-gray-300 mb-4" id="result-prompt-echo"></p>
                        <button id="download-button" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg w-full transition duration-200">
                            Download MP4
                        </button>
                        <div id="citation-box" class="mt-4 p-3 bg-slate-800 rounded-lg border border-slate-700">
                            <p class="text-xs font-semibold text-purple-300">Grounded in:</p>
                            <ul id="citation-list" class="text-xs text-gray-400 list-disc pl-5 mt-1">
                                <!-- Citations will be injected here -->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. Gallery Section -->
        <section id="gallery" class="container-section">
            <h2 class="text-4xl font-extrabold mb-8 pt-8">Community Showcase</h2>
            <p class="text-gray-300 mb-10">See the incredible potential of text-to-video AI. Click on a tile to see the prompt!</p>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Gallery Item 1 -->
                <div class="group bg-slate-800 rounded-xl overflow-hidden shadow-xl cursor-pointer hover:shadow-cyan-500/50 transition duration-300">
                    <div class="w-full h-48 bg-cover bg-center" style="background-image: url('https://placehold.co/600x400/1e293b/a5b4fc?text=Cinematic+City')"></div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg text-cyan-400">Neo-Tokyo Rain</h3>
                        <p class="text-sm text-gray-400 group-hover:text-white transition duration-200">
                            Prompt: A high-angle drone shot of a rainy, neon-drenched Tokyo street at 3 AM. Hyper-realistic, 8K.
                        </p>
                    </div>
                </div>
                <!-- Gallery Item 2 -->
                <div class="group bg-slate-800 rounded-xl overflow-hidden shadow-xl cursor-pointer hover:shadow-purple-500/50 transition duration-300">
                    <div class="w-full h-48 bg-cover bg-center" style="background-image: url('https://placehold.co/600x400/1e293b/c084fc?text=Fantasy+Forest')"></div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg text-purple-400">The Whispering Glade</h3>
                        <p class="text-sm text-gray-400 group-hover:text-white transition duration-200">
                            Prompt: A mysterious, glowing crystal floating in the center of an ancient, moss-covered forest. Gentle breeze, soft volumetric lighting.
                        </p>
                    </div>
                </div>
                <!-- Gallery Item 3 -->
                <div class="group bg-slate-800 rounded-xl overflow-hidden shadow-xl cursor-pointer hover:shadow-cyan-500/50 transition duration-300">
                    <div class="w-full h-48 bg-cover bg-center" style="background-image: url('https://placehold.co/600x400/1e293b/a5b4fc?text=Product+Demo+AI')"></div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg text-cyan-400">Abstract Data Flow</h3>
                        <p class="text-sm text-gray-400 group-hover:text-white transition duration-200">
                            Prompt: Fast-paced animation of abstract, swirling blue and green energy particles forming a perfect sphere. High contrast.
                        </p>
                    </div>
                </div>
                <!-- Gallery Item 4 -->
                <div class="group bg-slate-800 rounded-xl overflow-hidden shadow-xl cursor-pointer hover:shadow-purple-500/50 transition duration-300">
                    <div class="w-full h-48 bg-cover bg-center" style="background-image: url('https://placehold.co/600x400/1e293b/c084fc?text=Animated+Character')"></div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg text-purple-400">Pixel Samurai</h3>
                        <p class="text-sm text-gray-400 group-hover:text-white transition duration-200">
                            Prompt: A 16-bit pixel art samurai character bowing respectfully in front of a cherry blossom tree, 3-second loop.
                        </p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-400">
            <p>&copy; 2025 Vision AI. Powered by cutting-edge Gemini APIs.</p>
        </div>
    </footer>

    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // --- Navigation Logic ---
        function showSection(sectionId) {
            document.querySelectorAll('.container-section').forEach(section => {
                section.classList.remove('active-section');
            });
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.add('active-section');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                // Re-render Lucide icons for the newly shown section
                lucide.createIcons();
            }
        }

        document.querySelectorAll('.nav-link').forEach(button => {
            button.addEventListener('click', (e) => {
                const sectionId = e.target.getAttribute('data-section');
                showSection(sectionId);
            });
        });

        // Set initial view to home
        showSection('home');


        // --- Mock API/Generation Logic ---

        // Mock data structure for the API response simulation
        const mockApiResponse = {
            generatedText: "A high-quality video clip featuring a dynamic fly-through over mountainous terrain covered in fog, with the sun breaking through the clouds. This was generated using advanced diffusion techniques.",
            sources: [
                { title: "Advanced Diffusion Model Training", uri: "https://ai-research.google/diffusion-video-v3" },
                { title: "Prompt Engineering for Stability", uri: "https://ai-blog.google/prompting-for-video" }
            ]
        };

        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        // This function simulates the core LLM text generation logic
        // We will mock the image generation part and use the LLM for grounded text generation
        async function mockGeminiApiCall(userPrompt) {
             const systemPrompt = "You are an AI video generation assistant. Analyze the user's prompt and provide a brief, technical description of the type of video clip that would be generated, emphasizing high quality and style. Base your description on the user's input.";
             
             // Construct the payload for text generation with Google Search grounding
             const payload = {
                contents: [{ parts: [{ text: `Generate a detailed technical description for a video based on this user prompt: "${userPrompt}"` }] }],
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
             };

             const MAX_RETRIES = 5;
             let attempt = 0;
             while (attempt < MAX_RETRIES) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429) {
                            throw new Error('Rate limit exceeded');
                        }
                        console.error('API Error:', response.statusText);
                        // Fall through to process response structure if status allows
                    }

                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        const text = candidate.content.parts[0].text;
                        let sources = [];
                        const groundingMetadata = candidate.groundingMetadata;
                        
                        if (groundingMetadata && groundingMetadata.groundingAttributions) {
                            sources = groundingMetadata.groundingAttributions
                                .map(attribution => ({
                                    uri: attribution.web?.uri,
                                    title: attribution.web?.title,
                                }))
                                .filter(source => source.uri && source.title);
                        }

                        // Use a fallback if search returns no sources, to ensure the demo is robust
                        if (sources.length === 0) {
                            sources = mockApiResponse.sources;
                        }

                        return { generatedText: text, sources: sources };
                    } else {
                        throw new Error('Invalid response structure from API');
                    }
                } catch (error) {
                    if (error.message === 'Rate limit exceeded' && attempt < MAX_RETRIES - 1) {
                        const delay = Math.pow(2, attempt) * 1000 + Math.random() * 1000;
                        console.log(`Rate limit hit. Retrying in ${delay / 1000}s...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                        attempt++;
                    } else {
                        console.error("An error occurred during API call:", error);
                        return { 
                            generatedText: "Error: Could not process request. Generating a sample description instead. (Please check console for details).", 
                            sources: mockApiResponse.sources // Use mock sources on failure
                        };
                    }
                }
             }
        }

        async function handleGenerateVideo() {
            const prompt = document.getElementById('prompt-text').value.trim();
            const resultBox = document.getElementById('video-result');
            const detailsBox = document.getElementById('result-details');
            const loadingIndicator = document.getElementById('loading-indicator');
            const generateButton = document.getElementById('generate-button');

            if (prompt.length < 10) {
                // Simple feedback without using alert()
                resultBox.innerHTML = '<p class="text-red-400 font-semibold">Please enter a detailed prompt (min. 10 characters).</p>';
                detailsBox.classList.add('hidden');
                return;
            }

            // 1. Start Loading State
            generateButton.disabled = true;
            generateButton.innerHTML = '<i data-lucide="zap" class="inline-block w-5 h-5 animate-pulse mr-2"></i> Generating...';
            loadingIndicator.classList.remove('hidden');
            resultBox.innerHTML = '<p class="text-gray-400">Preparing AI model...</p>';
            detailsBox.classList.add('hidden');
            lucide.createIcons(); // Re-render icons after changing button content

            // 2. Simulate Video Generation Time (and run the API call in the background)
            const apiPromise = mockGeminiApiCall(prompt);
            
            // This is the core 'video generation' time simulation
            await new Promise(resolve => setTimeout(resolve, 3000)); // Wait 3 seconds for the demo

            const { generatedText, sources } = await apiPromise;

            // 3. End Loading State
            generateButton.disabled = false;
            generateButton.innerHTML = '<i data-lucide="video" class="inline-block w-6 h-6 mr-2"></i> Generate Video';
            loadingIndicator.classList.add('hidden');
            
            // 4. Update Results Display
            
            // Mock Video Display (Using a placeholder image and text)
            const ratio = document.getElementById('ratio-select').value;
            let videoPlaceholder = '';
            if (ratio === '9:16') {
                videoPlaceholder = `
                    <div class="relative w-40 h-80 rounded-lg overflow-hidden border-2 border-cyan-500 bg-slate-700 flex flex-col justify-center items-center">
                        <i data-lucide="smartphone" class="w-16 h-16 text-cyan-400/50 mb-2"></i>
                        <p class="text-xs text-gray-300 text-center px-2">Video Generated: ${ratio} Vertical</p>
                    </div>
                `;
            } else if (ratio === '1:1') {
                 videoPlaceholder = `
                    <div class="relative w-64 h-64 rounded-lg overflow-hidden border-2 border-cyan-500 bg-slate-700 flex flex-col justify-center items-center">
                        <i data-lucide="square" class="w-16 h-16 text-cyan-400/50 mb-2"></i>
                        <p class="text-xs text-gray-300 text-center px-2">Video Generated: ${ratio} Square</p>
                    </div>
                `;
            } else { // 16:9
                videoPlaceholder = `
                    <div class="relative w-full max-w-lg h-48 rounded-lg overflow-hidden border-2 border-cyan-500 bg-slate-700 flex flex-col justify-center items-center">
                        <i data-lucide="tv" class="w-16 h-16 text-cyan-400/50 mb-2"></i>
                        <p class="text-xs text-gray-300 text-center px-2">Video Generated: ${ratio} Landscape</p>
                    </div>
                `;
            }

            resultBox.innerHTML = videoPlaceholder;
            
            // Update details
            document.getElementById('result-prompt-echo').textContent = generatedText;
            
            // Update citations
            const citationList = document.getElementById('citation-list');
            citationList.innerHTML = ''; // Clear previous citations
            sources.forEach(source => {
                const li = document.createElement('li');
                li.innerHTML = `<a href="${source.uri}" target="_blank" class="text-cyan-400 hover:text-cyan-300 transition duration-200 truncate block">${source.title}</a>`;
                citationList.appendChild(li);
            });
            
            detailsBox.classList.remove('hidden');
            lucide.createIcons(); // Re-render icons one last time
        }

        // Example of handling download (mock)
        document.getElementById('download-button').addEventListener('click', () => {
            // In a real app, this would trigger a file download
            alertMessage("Download Initialized!", "Your video file is being prepared. In a real application, the download would start now.", "bg-green-600");
        });


        // Custom Modal/Message Box (to replace alert())
        function alertMessage(title, message, colorClass) {
            const modalId = 'custom-modal';
            let modal = document.getElementById(modalId);
            if (!modal) {
                modal = document.createElement('div');
                modal.id = modalId;
                modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4 hidden';
                document.body.appendChild(modal);
            }

            modal.innerHTML = `
                <div class="bg-slate-800 p-6 rounded-xl max-w-sm w-full shadow-2xl transform transition-all duration-300">
                    <div class="flex justify-between items-start mb-4">
                        <h4 class="text-xl font-bold ${colorClass.replace('bg-', 'text-')}">${title}</h4>
                        <button id="modal-close" class="text-gray-400 hover:text-white transition duration-200">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                    <p class="text-gray-300 mb-6">${message}</p>
                    <button id="modal-ok" class="w-full ${colorClass} text-white font-semibold py-2 rounded-lg hover:opacity-90 transition duration-200">
                        OK
                    </button>
                </div>
            `;
            
            lucide.createIcons();
            modal.classList.remove('hidden');

            const closeModal = () => modal.classList.add('hidden');
            document.getElementById('modal-close').onclick = closeModal;
            document.getElementById('modal-ok').onclick = closeModal;
        }

    </script>
</body>
</html>